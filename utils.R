# Plots preformatted Prophet CSV data

formatted_data <- function() {
    x <- tribble(
             ~ds,  
    '1949-01-01',
    '1949-02-01',
    '1949-03-01',
    '1949-04-01',
    '1949-05-01',
    '1949-06-01',
    '1949-07-01',
    '1949-08-01',
    '1949-09-01',
    '1949-10-01',
    '1949-11-01',
    '1949-12-01',
    '1950-01-01',
    '1950-02-01',
    '1950-03-01',
    '1950-04-01',
    '1950-05-01',
    '1950-06-01',
    '1950-07-01',
    '1950-08-01',
    '1950-09-01',
    '1950-10-01',
    '1950-11-01',
    '1950-12-01',
    '1951-01-01',
    '1951-02-01',
    '1951-03-01',
    '1951-04-01',
    '1951-05-01',
    '1951-06-01',
    '1951-07-01',
    '1951-08-01',
    '1951-09-01',
    '1951-10-01',
    '1951-11-01',
    '1951-12-01',
    '1952-01-01',
    '1952-02-01',
    '1952-03-01',
    '1952-04-01',
    '1952-05-01',
    '1952-06-01',
    '1952-07-01',
    '1952-08-01',
    '1952-09-01',
    '1952-10-01',
    '1952-11-01',
    '1952-12-01',
    '1953-01-01',
    '1953-02-01',
    '1953-03-01',
    '1953-04-01',
    '1953-05-01',
    '1953-06-01',
    '1953-07-01',
    '1953-08-01',
    '1953-09-01',
    '1953-10-01',
    '1953-11-01',
    '1953-12-01',
    '1954-01-01',
    '1954-02-01',
    '1954-03-01',
    '1954-04-01',
    '1954-05-01',
    '1954-06-01',
    '1954-07-01',
    '1954-08-01',
    '1954-09-01',
    '1954-10-01',
    '1954-11-01',
    '1954-12-01',
    '1955-01-01',
    '1955-02-01',
    '1955-03-01',
    '1955-04-01',
    '1955-05-01',
    '1955-06-01',
    '1955-07-01',
    '1955-08-01',
    '1955-09-01',
    '1955-10-01',
    '1955-11-01',
    '1955-12-01',
    '1956-01-01',
    '1956-02-01',
    '1956-03-01',
    '1956-04-01',
    '1956-05-01',
    '1956-06-01',
    '1956-07-01',
    '1956-08-01',
    '1956-09-01',
    '1956-10-01',
    '1956-11-01',
    '1956-12-01',
    '1957-01-01',
    '1957-02-01',
    '1957-03-01',
    '1957-04-01',
    '1957-05-01',
    '1957-06-01',
    '1957-07-01',
    '1957-08-01',
    '1957-09-01',
    '1957-10-01',
    '1957-11-01',
    '1957-12-01',
    '1958-01-01',
    '1958-02-01',
    '1958-03-01',
    '1958-04-01',
    '1958-05-01',
    '1958-06-01',
    '1958-07-01',
    '1958-08-01',
    '1958-09-01',
    '1958-10-01',
    '1958-11-01',
    '1958-12-01',
    '1959-01-01',
    '1959-02-01',
    '1959-03-01',
    '1959-04-01',
    '1959-05-01',
    '1959-06-01',
    '1959-07-01',
    '1959-08-01',
    '1959-09-01',
    '1959-10-01',
    '1959-11-01',
    '1959-12-01',
    '1960-01-01',
    '1960-02-01',
    '1960-03-01',
    '1960-04-01',
    '1960-05-01',
    '1960-06-01',
    '1960-07-01',
    '1960-08-01',
    '1960-09-01',
    '1960-10-01',
    '1960-11-01',
    '1960-12-01'
)

y <- tribble(
     ~y
  , 112
  , 118
  , 132
  , 129
  , 121
  , 135
  , 148
  , 148
  , 136
  , 119
  , 104
  , 118
  , 115
  , 126
  , 141
  , 135
  , 125
  , 149
  , 170
  , 170
  , 158
  , 133
  , 114
  , 140
  , 145
  , 150
  , 178
  , 163
  , 172
  , 178
  , 199
  , 199
  , 184
  , 162
  , 146
  , 166
  , 171
  , 180
  , 193
  , 181
  , 183
  , 218
  , 230
  , 242
  , 209
  , 191
  , 172
  , 194
  , 196
  , 196
  , 236
  , 235
  , 229
  , 243
  , 264
  , 272
  , 237
  , 211
  , 180
  , 201
  , 204
  , 188
  , 235
  , 227
  , 234
  , 264
  , 302
  , 293
  , 259
  , 229
  , 203
  , 229
  , 242
  , 233
  , 267
  , 269
  , 270
  , 315
  , 364
  , 347
  , 312
  , 274
  , 237
  , 278
  , 284
  , 277
  , 317
  , 313
  , 318
  , 374
  , 413
  , 405
  , 355
  , 306
  , 271
  , 306
  , 315
  , 301
  , 356
  , 348
  , 355
  , 422
  , 465
  , 467
  , 404
  , 347
  , 305
  , 336
  , 340
  , 318
  , 362
  , 348
  , 363
  , 435
  , 491
  , 505
  , 404
  , 359
  , 310
  , 337
  , 360
  , 342
  , 406
  , 396
  , 420
  , 472
  , 548
  , 559
  , 463
  , 407
  , 362
  , 405
  , 417
  , 391
  , 419
  , 461
  , 472
  , 535
  , 622
  , 606
  , 508
  , 461
  , 390
  , 432
)

df <- bind_cols(x,y)

df$ds <- as.Date(df$ds)

return(df)
}
run_forecast_with <- function(x, data.plot = 'Data') {
  
  x$ds <- as.Date(x$ds)
  m <- prophet(yearly.seasonality = TRUE)
  m <- fit.prophet(m, x)
  future <- make_future_dataframe(m, 365)
  forecast <- predict(m, future)
  
  #
  if(data.plot == 'Data') {
    forecast$ds <- as.Date(forecast$ds)
    df <- full_join(x, forecast)  
    return(df)
  }
  
  else{
    plot(m,forecast)
  }
  
}



